!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n="undefined"!=typeof globalThis?globalThis:n||self).exportFromJSON=t()}(this,function(){"use strict";function w(n){return"[object Array]"===Object.prototype.toString.call(n)}function O(n,t){if(!n)throw new Error(t)}function C(n){return Object.keys(n)}function N(t){return Object.keys(t).map(function(n){return[n,t[n]]})}function I(n,t,e){var r="."+t,t=new RegExp("(\\"+t+")?$");return e(n).replace(t,r)}function a(n){return"555xmlHello .  world!".trim().replace(/^([0-9,;]|(xml))+/,""),n.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")}function c(n){return Array(n+1).join(" ")}function i(n){return n.replace(/([<>&])/g,function(n,t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}})}function S(n,t,e){void 0===e&&(e="download");n=function(n,t){switch(t){case"txt":return"data:text/plain;charset=utf-8,"+encodeURIComponent(n);case"css":return"data:text/css;charset=utf-8,"+encodeURIComponent(n);case"html":return"data:text/html;charset=utf-8,"+encodeURIComponent(n);case"json":return"data:application/json;charset=utf-8,"+encodeURIComponent(n);case"csv":return"data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(n);case"xls":return"data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(n);case"xml":return"data:application/xml;charset=utf-8,"+encodeURIComponent(n);default:return""}}(n,t),t=document.createElement("a");t.href=n,t.download=e,t.setAttribute("style","visibility:hidden"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}var n,E=function(){return(E=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function R(n,t){var e="function"==typeof Symbol&&n[Symbol.iterator];if(!e)return n;var r,o,u=e.call(n),a=[];try{for(;(void 0===t||0<t--)&&!(r=u.next()).done;)a.push(r.value)}catch(n){o={error:n}}finally{try{r&&!r.done&&(e=u.return)&&e.call(u)}finally{if(o)throw o.error}}return a}function U(u){return u.map(N).reduce(function(n,t,o){return t.reduce(function(n,t){var e=R(t,2),r=e[0],t=e[1],e=n[r]||Array.from({length:u.length}).map(function(n){return""});return e[o]=("string"!=typeof t?JSON.stringify(t):t)||"",n[r]=e,n},n)},Object.create(null))}function J(n,t){return(t=void 0===t?function(n){return n}:t)(N(n).map(function(n){n=R(n,2);return{fieldName:n[0],fieldValues:n[1]}}))}function T(n,t){return n.length?'<html>\n  <head>\n    <meta charset="UTF-8">\n  </head >\n  <body>\n    '+(t=t=void 0===t?function(n){return n}:t,O(0<(n=n).length),"\n    <table>\n      <thead>\n        <tr><th><b>"+(t=J(U(n),t)).map(function(n){return n.fieldName}).join("</b></th><th><b>")+"</b></th></tr>\n      </thead>\n      <tbody>\n        <tr>"+t.map(function(n){return n.fieldValues}).map(function(n){return n.map(function(n){return"<td>"+n+"</td>"})}).reduce(function(n,e){return n.map(function(n,t){return""+n+e[t]})}).join("</tr>\n        <tr>")+"</tr>\n      </tbody>\n    </table>\n  ")+"\n  </body>\n</html >\n":""}function A(n){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>\n'+function e(n,t,r,o){void 0===r&&(r="element");void 0===o&&(o=0);var u=a(t);var t=c(o);if(null==n)return t+"<"+u+" />";var n=w(n)?n.map(function(n){return e(n,r,r,o+2)}).join("\n"):"object"==typeof n?N(n).map(function(n){var t=R(n,2),n=t[0],t=t[1];return e(t,n,r,o+2)}).join("\n"):t+"  "+i(String(n));var u=t+"<"+u+">\n"+n+"\n"+t+"</"+u+">";return u}(n,"base")+"\n"}function t(n){var t=n.data,e=n.fileName,r=void 0===e?"download":e,o=n.extension,u=n.fileNameFormatter,a=void 0===u?function(n){return n.replace(/\s+/,"_")}:u,c=n.fields,i=n.exportType,l=void 0===i?"txt":i,e=n.replacer,u=void 0===e?null:e,i=n.space,e=void 0===i?4:i,i=n.processor,f=void 0===i?S:i,i=n.withBOM,d=void 0!==i&&i,i=n.delimiter,s=void 0===i?",":i,n=n.beforeTableEncode,p=void 0===n?function(n){return n}:n,m="Invalid export data. Please provide an array of object",h="Can't export unknown data type "+l+".",v="Can't export string data to "+l+".";if("string"==typeof t)switch(l){case"txt":case"css":case"html":return f(t,l,I(r,null!=o?o:l,a));default:throw new Error(v)}var y,x,b=function(n){if(!n||w(n)&&!n.length||!w(n)&&!C(n).length)return function(n){return n};var r=w(n)?n.reduce(function(n,t){return E(E({},n),((n={})[t]=t,n))},Object.create(null)):n;return function(n){return w(n)?n.map(function(n){return N(n).reduce(function(n,t){var e=R(t,2),t=e[0],e=e[1];return t in r&&(n[r[t]]=e),n},Object.create(null))}).filter(function(n){return C(n).length}):N(n).reduce(function(n,t){var e=R(t,2),t=e[0],e=e[1];return t in r&&(n[r[t]]=e),n},Object.create(null))}}(c)(function(n){try{return"string"==typeof n?JSON.parse(n):n}catch(n){throw new Error("Invalid export data. Please provide a valid JSON")}}(t)),g=function(n,t,e){void 0===t&&(t=null);try{return JSON.stringify(n,t,e)}catch(n){throw new Error("Invalid export data. Please provide valid JSON object")}}(b,u,e);switch(l){case"txt":case"css":case"html":return f(g,l,I(r,null!=o?o:l,a));case"json":return f(g,l,I(r,null!=o?o:"json",a));case"csv":O(w(b),m);var j=(void 0===(x=s)&&(x=","),void 0===(j=p)&&(j=function(n){return n}),(y=b).length?(j=J(U(y),j)).map(function(n){return n.fieldName}).join(x)+"\r\n"+j.map(function(n){return n.fieldValues}).map(function(n){return n.map(function(n){return'"'+n.replace(/\"/g,'""')+'"'})}).reduce(function(n,e){return n.map(function(n,t){return""+n+x+e[t]})}).join("\r\n"):"");return f(d?"\ufeff"+j:j,l,I(r,null!=o?o:"csv",a));case"xls":return O(w(b),m),f(T(b,p),l,I(r,null!=o?o:"xls",a));case"xml":return f(A(b),l,I(r,null!=o?o:"xml",a));default:throw new Error(h)}}return(n=t=t||{}).types={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"},n.processors={downloadFile:S},t});
